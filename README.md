# shooting-game-programming

まずは、ゲームの土台となるhtmlを作成します
- canvas: ゲーム画面となる場所
- main.js: プログラミングを書く場所

## 宇宙を背景にした画面の作成

### 画面の構成要素
- フィールド(field): ゲームを描画している仮想の場所（見えない）
- スクリーン(screen): フィールドの一部を抜き取った仮想の画面（見えない）
- キャンバス(canvas): スクリーンをコピーして実際に映した場所（見える）
※スクリーンとキャンバスのアスペクト比を合わせないと映像が引き伸ばされるので注意

main.jsからhtmlのキャンバスに描画できるように必要な設定をしていく
- getElementByIdでhtmlの要素をmain.jsの変数で扱えるようにする
- キャンバスの幅と高さを設定する
- getContext("2d")で平面として扱うことを宣言します

### ランダム生成関数の作成
最小値と最大値を入力すると、その範囲の値を整数としてランダムに返す
- Math.random()は 0 ~ 1 の範囲で小数値を返す
- Math.floor(x)は x の小数部切り捨てる

### 星の作成
クラスを作成して、オブジェクトとして扱えるようにする
- コンストラクター
  - オブジェクトが生成されたときに最初に実行する
  - x,y: 位置、8bitシフト（256倍）した精度で管理する
  - size: 星の大きさ（単なる四角形の1辺）
- 描画
  - フレーム毎にキャンバスに描画する
  - 色: ランダムにすることで瞬きを表現
  - 描画: 位置と大きさを指定した四角形

### 描画処理
星オブジェクトをたくさん生成して、キャンバスに描画する
- 星の数を決めて、その分、生成処理をする
- 背景をブラックにしてキャンバスに描画する
- 生成した星をキャンバスに描画する

## ゲームのフレーム処理と仮想キャンバスの描画

### フレーム処理
フレームとは一秒間に何回描画するかを表す数字  
一般的なゲームは60FPS(frames per second)で、一秒間に60回描画している
- gameLoop: フレーム毎に呼ばれる関数を作成する
- GAME_SPEED: 1フレームのms(milliseconds)を定義する
- setInterval: gameLoopを１フレーム時間毎に呼び出す

### 星の移動
星が流れてくるように、移動情報と１フレーム毎の処理を実装する
- コンストラクター
  - vx, vy: 速度、フレーム毎に加算位置に加算する（8bitシフト）
- 情報更新
  - フレーム毎に処理する内容、移動や判定処理を記載する
  - 移動: 位置に速度を加算する
  - 再配置: 画面下まで移動したら、上に移動させる

### gameLoop
フレーム毎の処理
- キャンバスに背景を描画する
- 情報更新: 移動などの数値の変化処理をする
- 描画処理: 更新後の状態をキャンバスに描画する

### 仮想キャンバス
カメラワークの動きをつけることで、立体感を出す（後ほど、プレイヤーの動きに合わせてカメラワークさせる）  
そのために、仮想キャンバスにフィールド全体を描画し、その一部をスクリーンとして切り抜き、それをキャンバスに描画する
- 仮想キャンバス = フィールド: 新しくキャンバスを作成し、vContextとする
- カメラ = スクリーン: フィールドからの一部をスクリーンとして切り抜く
- キャンバス: スクリーンの描画情報をキャンバスにコピーする

仮想キャンバスへの描画と、キャンバスへのコピー
- 星クラスの描画処理は vContext に変更する
- 背景描画処理も vContext に変更する
- カメラ位置を定義して、スクリーンを切り抜く
- キャンバスにスクリーンをコピーして描画させる
